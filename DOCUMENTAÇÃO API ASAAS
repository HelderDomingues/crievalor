
Autentica√ß√£o
De que forma o Asaas identifica quem √© voc√™?
Suggest Edits
A autentica√ß√£o em nossa API √© feita atrav√©s do uso de uma chave de API. √â atrav√©s desta chave que nosso sistema identifica a sua conta e permite a comunica√ß√£o conosco em nome da conta em quest√£o.

Caso a chave de API seja inv√°lida, n√£o seja informada ou o header esteja incorreto, nossa API retornar√° HTTP 401.

A chave de API √© de responsabilidade do cliente. Para garantir a seguran√ßa, recomendamos que voc√™ utilize tamb√©m os demais mecanismos de prote√ß√£o dispon√≠veis. Considere definir endere√ßos IP autorizados para adicionar uma camada extra de seguran√ßa. Para mais detalhes, consulte as medidas de seguran√ßa na documenta√ß√£o: Mecanismos adicionais de seguran√ßa.

üöß
Aten√ß√£o:

Ap√≥s a gera√ß√£o da chave de API em nossa interface, armazene-a diretamente em seu cofre de chaves, evitando que seja exposta em mensagens de qualquer tipo ou emails. Nunca deixe a chave de API diretamente no c√≥digo fonte de seus sistemas.
N√£o informe sua chave de API em atendimentos, a terceiros ou exponha no front-end da sua aplica√ß√£o. Garanta que sua aplica√ß√£o n√£o exponha a chave em logs de sistema.
Caso seu time de desenvolvimento utilize a chave de API de Produ√ß√£o nos ambientes de desenvolvimento ou homologa√ß√£o durante os testes finais da integra√ß√£o, √© essencial renov√°-la antes da entrada em produ√ß√£o, garantindo que o menor n√∫mero de pessoas poss√≠vel tenha acesso a ela.
Utilize pelo menos um dos mecanismos adicionais de seguran√ßa descritos aqui.
A chave de API √© irrecuper√°vel, caso seja perdida, √© necess√°rio a gera√ß√£o de uma nova.
Utilize os headers abaixo em todas as suas chamadas para a API

JSON

"Content-Type": "application/json",
"User-Agent": "nome_da_sua_aplica√ß√£o",
"access_token": "sua_api_key"
üöß
Importante

√â obrigat√≥rio enviar o User-Agent no header de todas as requisi√ß√µes em novas contas raiz criadas a partir de 13/06/2024. Sugerimos enviar o nome da sua aplica√ß√£o caso o seu framework n√£o adicione um User-Agent padr√£o.
üìò
Ambientes distintos (sandbox e produ√ß√£o)

As Chaves de API s√£o distintas entre os ambientes de Sandbox e Produ√ß√£o, portanto lembre-se de alter√°-la quando mudar a URL.
Para obter sua Chave de API acesse a √°rea de integra√ß√µes em nossa interface web. Pelo aplicativo n√£o tem a op√ß√£o de gerar chave. Al√©m disso, apenas usu√°rios do tipo administrador, tem permiss√£o para gerar a chave.



üîí
Gerenciando suas chaves de API

Voc√™ pode criar at√© 10 chaves de API para uma conta Asaas.
As chaves podem ser nomeadas, para facilitar a identifica√ß√£o.
√â poss√≠vel definir uma data de expira√ß√£o para cada chave.
Voc√™ pode desabilitar/habilitar uma chave a qualquer momento, sem de fato inv√°lida-la.
Caso a chave seja exclu√≠da, n√£o √© poss√≠vel restaura-la.
URL de Produ√ß√£o e Sandbox

Ap√≥s a cria√ß√£o da conta e gera√ß√£o da chave de API, utilize a URL espec√≠fica para cada ambiente em suas chamadas, conforme listado abaixo:

Ambiente	URL
Produ√ß√£o	https://api.asaas.com/v3
Sandbox	https://api-sandbox.asaas.com/v3
Teste em ambiente Sandbox

Durante o desenvolvimento da integra√ß√£o, teste as requisi√ß√µes em nosso ambiente de Sandbox utilizando dados fict√≠cios e direcionando as requisi√ß√µes para o dom√≠nio ‚Äúhttps://api-sandbox.asaas.com/v3", alterando para produ√ß√£o apenas ap√≥s a valida√ß√£o de todas as funcionalidades.

Armazenamento seguro para a Chave de API

A Chave de API do Asaas segue o modelo de chave ‚Äúirrecuper√°vel‚Äù, isto √©, ela ser√° exibida apenas uma vez quando criada. Sendo assim, voc√™ precisar√° copi√°-la e salv√°-la de modo seguro antes de sair da √°rea de integra√ß√µes.

Nunca armazene chaves de API em texto claro dentro do c√≥digo-fonte ou em arquivos de configura√ß√£o acess√≠veis ao p√∫blico.

Utilize mecanismos de seguran√ßa, como vari√°veis de ambiente ou arquivos de configura√ß√£o protegidos, para armazenar as chaves de API de forma segura.

Utilize servi√ßos de gerenciamento de segredos para armazenar e gerenciar as chaves de API de forma centralizada e segura, como AWS Secrets Manager, Google Cloud Secret Manager e Azure Key Vault, por exemplo.

Transmiss√£o segura da sua Chave de API

Utilize exclusivamente protocolos de comunica√ß√£o seguros, como HTTPS, evitando m√©todos n√£o criptografados, como HTTP.
Protocolo de seguran√ßa TLS (Transport Layer Security)

Atualmente nossos sistemas em produ√ß√£o aceitam TLS 1.2 e 1.3 para comunica√ß√£o. Mas recomendamos o uso do TLS 1.3.

Controle de acesso e rota√ß√£o de chave

O acesso √† Chave de API deve ser concedido apenas a usu√°rios ou sistemas autorizados que realmente necessitam de acesso aos recursos protegidos.
Estabele√ßa um processo de monitoramento dos logs a fim de rastrear a origem e prop√≥sito das requisi√ß√µes, de modo a detectar atividades suspeitas ou uso indevido de sua Chave de API. Ferramentas como SIEM, Splunk, ELK Stack, AWS CloudWatch ou Azure Monitor podem auxiliar no processo.
Estabele√ßa uma pol√≠tica de rota√ß√£o regular das chaves de API para reduzir o impacto em caso de comprometimento ou vazamento.
O armazenamento e seguran√ßa da chave apikey √© de inteira responsabilidade do cliente, visto que o Asaas n√£o det√©m dessa informa√ß√£o armazenada em nenhum local de nosso banco.

Mecanismos adicionais de seguran√ßa
Utilize os mecanismos abaixo para maior seguran√ßa em sua conta.
Suggest Edits
Al√©m de chave de API que √© usada para autenticar suas requisi√ß√µes, possu√≠mos mecanismos adicionais que oferecem camadas extras de seguran√ßa para sua conta. Recomendamos utilizar pelo menos um deles, e se poss√≠vel ambos. Conhe√ßa-os abaixo.

Whitelist de IPs

Este mecanismo permite definir IPs a partir dos quais aceitaremos requisi√ß√µes utilizando sua chave de API.

Qualquer requisi√ß√£o recebida de um IP n√£o contido na whitelist ser√° recusada com resposta HTTP 403. Desta forma, mesmo que sua chave seja comprometida, a menos que as requisi√ß√µes partam de sua infraestrutura, elas ser√£o recusadas.

Voc√™ pode definir a sua lista de IPs autorizados acessando Menu do usu√°rio > Integra√ß√µes > Mecanismos de seguran√ßa.



üìò
Configura√ß√£o de IPs por faixa

Voc√™ consegue adicionar um IP autorizado em uma faixa de IPs, usando o x, por exemplo: 192.168.1.x ir√° pegar desde o IP 192.168.1.0 at√© 192.168.1.255.
Por que fixar IPs?

Fixar IPs para chamadas de API pode ser uma pr√°tica √∫til e necess√°ria por diversas raz√µes.

Restri√ß√£o de Acesso: Ao fixar IPs, voc√™ pode restringir o acesso √†s suas APIs, permitindo chamadas apenas de IPs espec√≠ficos. Isso ajuda a bloquear acessos n√£o autorizados ou indesejados, como tentativas de invas√£o ou ataques DDoS.
Autentica√ß√£o e Filtragem de IP: Muitas APIs e servi√ßos de backend permitem a configura√ß√£o de filtros de IP para garantir que apenas sistemas ou servidores conhecidos possam acessar a API. Esse tipo de controle aumenta a seguran√ßa do seu sistema.
Fixar IPs para chamadas de API √© uma pr√°tica que pode oferecer mais controle sobre seguran√ßa, desempenho, auditoria e conformidade regulat√≥ria. No entanto, isso tamb√©m exige a manuten√ß√£o de uma lista de IPs autorizados e pode tornar o gerenciamento de acessos mais complexo. A decis√£o de fixar ou n√£o os IPs depende muito do contexto de seguran√ßa e da infraestrutura da aplica√ß√£o ou servi√ßo.

Webhook de autoriza√ß√£o de transfer√™ncias

Ao habilitar este mecanismo, todas as transfer√™ncias solicitadas em sua conta disparar√£o um webhook para o seu sistema afim de validar a legitimidade das mesmas. Desta forma, a menos que seu sistema reconhe√ßa a transfer√™ncia como leg√≠tima, ela ser√° cancelada. Para maiores detalhes no uso deste mecanismo acesso √† documenta√ß√£o.

Criando um link de pagamentos
Suggest Edits
Para criar um link de pagamentos, basta chamar o endpoint de link de pagamentos.

POST /v3/paymentLinks
Confira a refer√™ncia completa deste endpoint.
JSON

{
  "name": "Venda de livros",
  "description": "Qualquer livro por apenas R$: 50,00",
  "value": 50.00,
  "billingType": "UNDEFINED",
  "chargeType": "DETACHED",
  "dueDateLimitDays": 10
}
No exemplo acima, uma nova cobran√ßa avulsa de R$ 50 ser√° criada cada vez que um cliente preencher este link de pagamentos. Ele ficar√° ativo at√© que seja desabilitado ou deletado.

Tamb√©m √© poss√≠vel criar link de pagamentos para pagamentos parcelados, nesse sentido voc√™ apenas informa qual a quantidade m√°xima de parcelas dispon√≠veis e o cliente ir√° escolher qual forma deseja fazer o pagamento.

POST /v3/paymentLinks
Confira a refer√™ncia completa deste endpoint.
JSON

{
  "billingType": "CREDIT_CARD",
  "chargeType": "INSTALLMENT",
  "name": "Venda de eletr√¥nicos",
  "description": "Qualquer produto em at√© 10x de R$ 50,00",
  "value": 500.00,
  "maxInstallmentCount": 10,
  "notificationEnabled": false
}
No exemplo acima, como n√£o temos BOLETO no billingType n√£o foi necess√°rio informar o campo dueDateLimitDays. Tamb√©m definimos o notificationEnabled como false, dessa forma os clientes que preencherem este link de pagamento n√£o ter√£o notifica√ß√µes ativas.

Da mesma forma, tamb√©m √© poss√≠vel criar links de pagamentos que criam assinaturas. Bastando informar o chargeType como RECURRENT.

POST /v3/paymentLinks
Confira a refer√™ncia completa deste endpoint.
JSON

{
  "billingType": "CREDIT_CARD",
  "chargeType": "RECURRENT",
  "name": "Assinatura de livros",
  "description": "Receba um livro todo m√™s por R$: 50,00",
  "value": 50.00,
  "subscriptionCycle": "MONTHLY"
}
Como saber se um link de pagamentos foi pago?

Toda vez que um link de pagamentos √© pago, voc√™ recebe um evento no Webhook para Cobran√ßas. No JSON retornado voc√™ ter√° acesso ao campo paymentLink com o ID do seu link de pagamento.

Neste mesmo JSON voc√™ ter√° acesso ao customer com o ID do seu cliente, e poder√° pegar os dados do mesmo caso precise usando o endpoint "Recuperar um √∫nico cliente".

Adicionando imagens em um link de pagamentos

√â poss√≠vel adicionar at√© 5 imagens em um link de pagamentos e voc√™ pode fazer isso chamando o endpoint abaixo:

POST /v3/paymentLinks/{id}/images
Confira a refer√™ncia completa deste endpoint
Voc√™ pode definir se a imagem √© a principal, com o campo main sendo enviado como true. O envio dos arquivos deve ser com o header Content-Type: multipart/form-data.

üöß
Duplica√ß√£o de clientes em links de pagamento

No Asaas, √© poss√≠vel criar clientes com CPF/CNPJ duplicados. Pelo link de pagamento, como o cliente √© sempre criado no momento da gera√ß√£o da cobran√ßa, caso ele j√° exista no Asaas, o cliente ser√° cadastrado novamente, aparecendo duas ou mais vezes (a depender da quantidade de vezes que gerou a cobran√ßa).

Criar um link de pagamentos
POST
https://api-sandbox.asaas.com/v3/paymentLinks
Caso o seu cliente possa pagar via boleto banc√°rio, ser√° necess√°rio informar o campo dueDateLimitDays, que determina a quantidade de dias √∫teis para a realiza√ß√£o do pagamento ap√≥s a gera√ß√£o do boleto.

Se a forma de cobran√ßa for Parcelamento, informe o campo maxInstallmentCount para determinar o limite m√°ximo de parcelas que seu cliente poder√° escolher para realizar o pagamento parcelado.

J√° se a forma de cobran√ßa ser Assinatura, ser√° necess√°rio o envio do campo subscriptionCycle para determinar a periodicidade da gera√ß√£o das cobran√ßas.

Voc√™ poder√° adicionar imagens ao seu link de pagamentos por meio deste endpoint
BODY PARAMS
name
string
required
Nome do link de pagamentos
description
string
Descri√ß√£o do link de pagamentos
endDate
string
Data de encerramento
value
number
Valor do link de pagamentos, caso n√£o informado o pagador poder√° informar o quanto deseja pagar
billingType
string
required
Forma de pagamento permitida

chargeType
string
required
Forma de cobran√ßa

dueDateLimitDays
int32
Quantidade de dias √∫teis que o seu cliente poder√° pagar ap√≥s o boleto ser gerado (Para forma de pagamento como Boleto)
subscriptionCycle
string
Periodicidade da cobran√ßa, caso o chargeType seja RECURRENT

maxInstallmentCount
int32
Defaults to 1
Quantidade m√°xima de parcelas que seu cliente poder√° parcelar o valor do link de pagamentos caso a forma de cobran√ßa selecionado seja Parcelamento. Caso n√£o informado o valor padr√£o ser√° de 1 parcela
externalReference
string
Campo livre para busca
notificationEnabled
boolean
Defaults to true
Define se os clientes cadastrados pelo link de pagamentos ter√£o as notifica√ß√µes habilitadas. Caso n√£o seja informado o valor padr√£o ser√° true

callback
object
Informa√ß√µes de redirecionamento autom√°tico ap√≥s pagamento do link de pagamento

CALLBACK OBJECT
isAddressRequired
boolean
True para tornar obrigat√≥rio o preenchimento de dados de endere√ßo no checkout.

RESPONSES


200
OK


401
Unauthorized

Criar novo cliente
POST
https://api-sandbox.asaas.com/v3/customers
Para que seja poss√≠vel criar uma cobran√ßa, antes √© necess√°rio criar o cliente ao qual ela ir√° pertencer. Voc√™ deve utilizar o ID retornado nesta requisi√ß√£o na cria√ß√£o da cobran√ßa.

Caso voc√™ envie o postalCode do cliente, n√£o √© necess√°rio enviar os atributos city, province e address, pois o Asaas preencher√° estas informa√ß√µes automaticamente com base no CEP que voc√™ informou. Nestes casos basta enviar somente postalCode e addressNumber.

No campo city √© retornado um identificador. Caso voc√™ queira obter o nome e demais informa√ß√µes da cidade voc√™ deve fazer a seguinte requisi√ß√£o utilizando esse identificador:
GET https://api.asaas.com/v3/cities/{city_id}

üöß
Aten√ß√£o

O sistema permite a cria√ß√£o de clientes duplicados. Portanto, se voc√™ n√£o quiser permitir √© necess√°rio implementar a valida√ß√£o antes de realizar a cria√ß√£o do cliente. Voc√™ pode consultar a exist√™ncia do cliente no Listar Clientes.
üìò
Produ√ß√£o: Caso seu cliente seja estrangeiro, ser√° necess√°rio entrar em contato com seu Gerente de Contas para que ele solicite a libera√ß√£o em seu cadastro de cria√ß√£o de clientes estrangeiros.

Sandbox: Em sandbox √© poss√≠vel gerar clientes estrangeiros sem libera√ß√£o pr√©via.
üöß
Importante

O envio e recebimento de notifica√ß√µes de email e SMS funcionam normalmente em Sandbox. Portanto voc√™ n√£o deve criar clientes com emails e celulares reais ou n√∫meros aleat√≥rios como (51) 9999-9999. Para testar o recebimento de notifica√ß√µes voc√™ pode utilizar os seus pr√≥prios emails e celulares.
BODY PARAMS
name
string
required
Nome do cliente
cpfCnpj
string
required
CPF ou CNPJ do cliente
email
string
Email do cliente
phone
string
Fone fixo
mobilePhone
string
Fone celular
address
string
Logradouro
addressNumber
string
N√∫mero do endere√ßo
complement
string
Complemento do endere√ßo (m√°x. 255 caracteres)
province
string
Bairro
postalCode
string
CEP do endere√ßo
externalReference
string
Identificador do cliente no seu sistema
notificationDisabled
boolean
true para desabilitar o envio de notifica√ß√µes de cobran√ßa

additionalEmails
string
Emails adicionais para envio de notifica√ß√µes de cobran√ßa separados por ","
municipalInscription
string
Inscri√ß√£o municipal do cliente
stateInscription
string
Inscri√ß√£o estadual do cliente
observations
string
Observa√ß√µes adicionais
groupName
string
Nome do grupo ao qual o cliente pertence
company
string
Empresa
foreignCustomer
boolean
informe true caso seja pagador estrangeiro

RESPONSES


200
OK


401
Unauthorized

Listar clientes
GET
https://api-sandbox.asaas.com/v3/customers
Diferente da recupera√ß√£o de um cliente espec√≠fico, este m√©todo retorna uma lista paginada com todos os clientes para os filtros informados.

Filtrar por nome:

GET https://api.asaas.com/v3/customers?name=Marcelo

Filtrar por CPF ou CNPJ:

GET https://api.asaas.com/v3/customers?cpfCnpj=42885229519
QUERY PARAMS
offset
integer
Elemento inicial da lista
limit
integer
‚â§ 100
N√∫mero de elementos da lista (max: 100)
name
string
Filtrar por nome
email
string
Filtrar por email
cpfCnpj
string
Filtrar por CPF ou CNPJ
groupName
string
Filtrar por grupo
externalReference
string
Filtrar pelo Identificador do seu sistema
RESPONSES


200
OK


401
Unauthorized

403
Forbidden. Ocorre quando o body da requisi√ß√£o est√° preenchido, chamadas de m√©todo GET precisam ter um body vazio.

Recuperar um √∫nico cliente
GET
https://api-sandbox.asaas.com/v3/customers/{id}
PATH PARAMS
id
string
required
Identificador √∫nico do cliente no Asaas
RESPONSES


200
OK


401
Unauthorized

403
Forbidden. Ocorre quando o body da requisi√ß√£o est√° preenchido, chamadas de m√©todo GET precisam ter um body vazio.

404
Not found

Atualizar cliente existente
PUT
https://api-sandbox.asaas.com/v3/customers/{id}
PATH PARAMS
id
string
required
Identificador √∫nico do cliente a ser atualizado
BODY PARAMS
name
string
Nome do cliente
cpfCnpj
string
CPF ou CNPJ do cliente
email
string
Email do cliente
phone
string
Fone fixo
mobilePhone
string
Fone celular
address
string
Logradouro
addressNumber
string
N√∫mero do endere√ßo
complement
string
Complemento do endere√ßo
province
string
Bairro
postalCode
string
CEP do endere√ßo
externalReference
string
Identificador do cliente no seu sistema
notificationDisabled
boolean
true para desabilitar o envio de notifica√ß√µes de cobran√ßa

additionalEmails
string
Emails adicionais para envio de notifica√ß√µes de cobran√ßa separados por ","
municipalInscription
string
Inscri√ß√£o municipal do cliente
stateInscription
string
Inscri√ß√£o estadual do cliente
observations
string
Observa√ß√µes adicionais
groupName
string
Nome do grupo ao qual o cliente pertence
company
string
Empresa
foreignCustomer
boolean
informe true caso seja pagador estrangeiro

RESPONSES


200
OK


401
Unauthorized

404
Not found

Remover cliente
DELETE
https://api-sandbox.asaas.com/v3/customers/{id}
üöß
Ao remover um cliente, as assinaturas e cobran√ßas aguardando pagamento ou vencidas pertencentes a ela tamb√©m s√£o removidas.
PATH PARAMS
id
string
required
Identificador √∫nico do cliente a ser removido.
RESPONSES


200
OK


401
Unauthorized

404
Not found

Restaurar cliente removido
POST
https://api-sandbox.asaas.com/v3/customers/{id}/restore
PATH PARAMS
id
string
required
Identificador √∫nico do cliente a ser restaurado.
RESPONSES


200
OK


401
Unauthorized

404
Not found

Receba eventos do Asaas no seu endpoint de Webhook
Configure uma URL de webhook para manter sua aplica√ß√£o sempre atualizada com a integra√ß√£o da API
Suggest Edits
Siga este tutorial para criar seu primeiro Webhook.

O objeto de evento

Eventos s√£o objetos enviados em formato JSON via webhooks do Asaas. Eles s√£o respons√°veis por avisar quando algum evento aconteceu em sua conta.

Atrav√©s dele voc√™ ter√° acesso ao id, event indicando qual seu evento e o objeto da entidade da qual o evento pertence, no exemplo abaixo temos o objeto payment com os dados da cobran√ßa em quest√£o.

JSON

{
   "id": "evt_05b708f961d739ea7eba7e4db318f621&368604920",
   "event":"PAYMENT_RECEIVED",
   "dateCreated": "2024-06-12 16:45:03",
   "payment":{
      "object":"payment",
      "id":"pay_080225913252",
      ...
   }
}
Os webhooks s√£o a forma que voc√™ usa para inscrever-se em eventos e receber notifica√ß√µes na sua aplica√ß√£o sempre que o evento acontece.

Tipos de eventos

Os eventos s√£o divididos por categorias relacionadas a entidade ao qual eles pertencem. Confira a p√°gina Eventos de Webhooks para conferir cada um.

Comece por aqui

Para come√ßar a receber eventos atrav√©s de webhooks na sua aplica√ß√£o, siga os passos abaixo:

Acesse o ambiente de Sandbox;
Crie um endpoint na sua aplica√ß√£o para receber requests HTTP do tipo POST;
Configure seu webhook usando nossa aplica√ß√£o web ou via API;
Teste seu webhook;
Realize debug em problemas com eventos;
Ap√≥s testado e validado, replique a configura√ß√µes no ambiente de Produ√ß√£o;
Mantenha seu webhook seguro.
Crie um endpoint

Crie um endpoint que espera receber um objeto de evento em um evento de POST. Este endpoint tamb√©m deve retornar o mais r√°pido poss√≠vel uma resposta 200, para evitar problemas na fila de sincroniza√ß√£o de eventos.

Abaixo um exemplo b√°sico usando Node.js:

Node.js
PHP
Java
Python

const express = require('express');
const app = express();

app.post('/payments-webhook', express.json({type: 'application/json'}), (request, response) => {
  const body = request.body;

  switch (body.event) {
    case 'PAYMENT_CREATED':
      const payment = body.payment;
      createPayment(payment);
      break;
    case 'PAYMENT_RECEIVED':
      const payment = body.payment;
      receivePayment(payment)
      break;
    // ... trate outos eventos
    default:
      console.log(`Este evento n√£o √© aceito ${body.event}`);
  }

  // Retorne uma resposta para dizer que o webhook foi recebido
  response.json({received: true});
});

app.listen(8000, () => console.log('Running on port 8000'));
Configure seu webhook

Voc√™ pode realizar a configura√ß√£o de um novo webhook via aplica√ß√£o web ou via API.

Recomendamos, para testar seu webhook e sua integra√ß√£o, que voc√™ primeiro precisa crie uma conta em Sandbox. Confira nossa documenta√ß√£o sobre o Sandbox e siga os passos. Voc√™ tamb√©m pode seguir os tutoriais de cria√ß√£o de webhook:

Criar novo webhook pela aplica√ß√£o web
Criar novo webhook pela API
Teste seu webhook

Com o webhook em Sandbox configurado, voc√™ pode testar seu c√≥digo que est√° em localhost usando algumas aplica√ß√µes que exp√µe o seu c√≥digo local na web.

Recomendamos usar uma aplica√ß√£o de confian√ßa como o ngrok ou o Cloudflare Tunnel. Com ambas aplica√ß√µes voc√™ pode definir uma url que pode utilizar na configura√ß√£o do seu webhook.

Debugar integra√ß√£o com webhooks

Voc√™ pode facilmente debugar seu webhook atrav√©s da nossa p√°gina de logs de Webhooks. Acesse Menu do Usu√°rio > Integra√ß√µes > Logs de Webhooks.


Nesta p√°gina voc√™ poder√° visualizar todas as requisi√ß√µes enviadas via webhook para sua aplica√ß√£o, qual o status retornado pelo seu servidor e tamb√©m qual o conte√∫do enviado. Essa p√°gina √© relevante tamb√©m quando voc√™ tiver problemas com a fila de sincroniza√ß√£o pausada , confira a documenta√ß√£o para mais detalhes.

Mantenha seu webhook seguro

√â altamente recomendado que voc√™ mantenha sua integra√ß√£o e todos os seus webhooks seguros. Como recomenda√ß√£o, o Asaas sugere:

Confie somente nos IPs do Asaas para chamadas em webhooks: voc√™ pode realizar o bloqueio via firewall em todos os IPs que realiza√ß√£o chamadas nas suas URLs de webhooks, exceto os IPs oficiais do Asaas.
Configure um accessToken: ao criar um novo webhook, voc√™ pode definir um c√≥digo √∫nico para ele. Crie uma hash forte, de prefer√™ncia um UUID v4, e confira sempre o header asaas-access-token para certificar que esta √© uma chamada leg√≠tima.

Como implementar idempot√™ncia em Webhooks
Suggest Edits
Os webhooks do Asaas garantem que os eventos ser√£o enviados ao menos uma vez, ou seja, seguem a premissa "at least once". Isso significa que seu endpoint pode, ocasionalmente, receber o mesmo evento de webhook repetidamente em algumas situa√ß√µes espor√°dicas. Como, por exemplo, numa situa√ß√£o em que o Asaas n√£o recebe uma resposta do seu endpoint.

Dito isso, o ideal √© que sua aplica√ß√£o saiba tratar os eventos recebidos com duplicidade utilizando idempot√™ncia e este artigo tem o objetivo de explicar como a idempot√™ncia funciona e como voc√™ pode proteger a sua aplica√ß√£o.

O que √© idempot√™ncia?

Idempot√™ncia se refere a capacidade que uma opera√ß√£o (fun√ß√£o) tem de retornar constantemente o mesmo resultado independente da quantidade de vezes que possa ser executada, desde que os par√¢metros se mantenham sempre os mesmos.

Trazendo para o contexto de webhook, se o Asaas ocasionalmente enviar o mesmo webhook duas vezes, o ideal √© que a sua aplica√ß√£o responda √†s duas requisi√ß√µes com HTTP Status 200, mantendo sempre o mesmo retorno da primeira requisi√ß√£o recebida.

Por que usar idempot√™ncia?

Antes de explicarmos o porqu√™ de utilizar idempot√™ncia, vamos analisar os principais verbos HTTP: GET, PUT, DELETE e POST.

Aplicando os padr√µes REST corretamente na sua aplica√ß√£o, os verbos GET, PUT e DELETE ser√£o sempre idempotentes:

O GET √© um verbo de consulta que n√£o altera o estado do recurso.
O PUT, se executado diversas vezes com os mesmos par√¢metros, sempre retornar√° o mesmo resultado.
O DELETE na primeira requisi√ß√£o torna o estado do recurso como ‚Äúexclu√≠do‚Äù, mesmo que sejam enviadas outras requisi√ß√µes de DELETE, o estado do recurso se manter√° o mesmo.
No entanto, o verbo POST √© o √∫nico dos verbos HTTPs que n√£o possui o comportamento de idempot√™ncia por padr√£o:

O POST pode criar um novo recurso √∫nico a cada vez que a opera√ß√£o for executada.
Os webhooks que s√£o disparados pelo Asaas, por padr√£o, utilizam o verbo POST e √© por isso que √© importante que a sua aplica√ß√£o aplique o conceito de idempot√™ncia para que o recebimento de webhooks repetidos n√£o interfira na l√≥gica aplicada pelo seu sistema.

Estrat√©gias de idempot√™ncia

Usando um index √∫nico no banco de dados

Os eventos enviados pelos Webhooks do Asaas possuem IDs √∫nicos e, mesmo que eles sejam enviados mais de uma vez, voc√™ sempre receber√° o mesmo ID. Uma das estrat√©gias √© criar uma fila de eventos no seu banco de dados e utilizar esse ID como uma chave √∫nica, desta maneira voc√™ n√£o conseguir√° salvar dois IDs iguais

SQL

CREATE TABLE asaas_events (
    id bigint PRIMARY KEY,
    asaas_event_id text UNIQUE NOT NULL,
    payload JSON NOT NULL,
    status ENUM('PENDING','DONE') NOT NULL
    [...]
);

O indicado √© que ao receber o evento do Asaas na sua aplica√ß√£o, voc√™ salve essa informa√ß√£o em uma tabela como mostrada acima e responda 200 para o Asaas para indicar o recebimento com sucesso. Lembre-se de retornar 200 somente ap√≥s a confirma√ß√£o da persist√™ncia do evento na sua tabela no banco de dados, pois n√£o garantimos que este evento ser√° reenviado automaticamente.

Ap√≥s isso, crie uma rotina de processamento, como Cron Jobs ou Workers, para processar os eventos persistidos e n√£o processados (status = PENDING), assim que finalizar o seu processamento, marque-os com o status DONE ou simplesmente remova o registro da tabela. Caso a ordem dos eventos seja importante para o seu sistema, lembre-se de buscar e process√°-los de forma ascendente.

Node.js

const express = require('express');
const app = express();

app.post('/asaas/webhooks/payments', express.json({type: 'application/json'}), (request, response) => {
  const body = request.body;
  const eventId = body.id;
  const eventType = body.event;
  const payload = body; // Salvar o payload inteiro para verificar o "event" no processamento
  const status = "PENDING";
  
  await client
    .query("INSERT INTO asaas_events (asaas_event_id, payload, status) VALUES ($1, $2, $3)", [eventId, payload, status])
    .catch((e) => {
      // PostgreSQL code for unique violation
      if (e.code == "23505") {
        response.json({received: true});
        return;
      }
      throw e;
    });

  // Retorne uma resposta para dizer que o webhook foi recebido
  response.json({received: true});
});

app.listen(8000, () => console.log('Running on port 8000'));
Se o seu sistema recebe mais de centenas de milhares de eventos por dia, a indica√ß√£o √© utilizar uma solu√ß√£o de fila mais robusta, como Amazon SQS, RabbitMQ ou Kafka.

Nesta solu√ß√£o, al√©m de resolver o ponto da idempot√™ncia, a sugest√£o tamb√©m √© que o processamento dos eventos seja ass√≠ncrono, logo tendo uma resposta mais r√°pida para o Asaas e uma vaz√£o maior da fila de eventos enviados.

Salvar eventos j√° processados

Outra estrat√©gia comum √© realizar o processamento dos Webhooks e salvar o ID de cada evento em uma tabela.

SQL

CREATE TABLE asaas_processed_webhooks (
    id bigint PRIMARY KEY,
    asaas_evt_id text UNIQUE NOT NULL,
    [...]
);
Dessa forma voc√™ pode sempre verificar essa tabela quando receber um novo evento e verificar se o ID j√° foi processado anteriormente.

Node.js

const express = require('express');
const app = express();

app.post('/asaas/webhooks/payments', express.json({type: 'application/json'}), (request, response) => {
  const body = request.body;

  const eventId = body.id;

  
  await client
    .query("INSERT INTO asaas_processed_webhooks (asaas_evt_id) VALUES $1", [eventId])
    .catch((e) => {
      // PostgreSQL code for unique violation
      if (e.code == "23505") {
        response.json({received: true});
        return;
      }
      throw e;
    });

  switch (body.event) {
    case 'PAYMENT_CREATED':
      const payment = body.payment;
      createPayment(payment);
      break;
    // ... trate outos eventos
    default:
      console.log(`Este evento n√£o √© aceito ${body.event}`);
  }

  // Retorne uma resposta para dizer que o webhook foi recebido
  response.json({received: true});
});

app.listen(8000, () => console.log('Running on port 8000'));

Nesta solu√ß√£o, a tabela √© usada como um check ap√≥s o processamento, esse que √© feito ainda nos 10s de limite de timeout que o Asaas tem da requisi√ß√£o.

Eventos para cobran√ßas
Escute os eventos do Asaas para ter sua integra√ß√£o em dia.
Suggest Edits
Os Webhooks s√£o a melhor e mais segura forma de manter os dados da sua aplica√ß√£o atualizados com os dados do Asaas. Voc√™ sempre receber√° um novo evento quando o status do Webhook mudar. Os eventos que o Asaas notifica s√£o:

PAYMENT_CREATED - Gera√ß√£o de nova cobran√ßa.
PAYMENT_AWAITING_RISK_ANALYSIS - Pagamento em cart√£o aguardando aprova√ß√£o pela an√°lise manual de risco.
PAYMENT_APPROVED_BY_RISK_ANALYSIS - Pagamento em cart√£o aprovado pela an√°lise manual de risco.
PAYMENT_REPROVED_BY_RISK_ANALYSIS - Pagamento em cart√£o reprovado pela an√°lise manual de risco.
PAYMENT_AUTHORIZED - Pagamento em cart√£o que foi autorizado e precisa ser capturado.
PAYMENT_UPDATED - Altera√ß√£o no vencimento ou valor de cobran√ßa existente.
PAYMENT_CONFIRMED - Cobran√ßa confirmada (pagamento efetuado, por√©m, o saldo ainda n√£o foi disponibilizado).
PAYMENT_RECEIVED - Cobran√ßa recebida.
PAYMENT_CREDIT_CARD_CAPTURE_REFUSED - Falha no pagamento de cart√£o de cr√©dito
PAYMENT_ANTICIPATED - Cobran√ßa antecipada.
PAYMENT_OVERDUE - Cobran√ßa vencida.
PAYMENT_DELETED - Cobran√ßa removida.
PAYMENT_RESTORED - Cobran√ßa restaurada.
PAYMENT_REFUNDED - Cobran√ßa estornada.
PAYMENT_PARTIALLY_REFUNDED - Cobran√ßa estornada parcialmente.
PAYMENT_REFUND_IN_PROGRESS - Estorno em processamento (liquida√ß√£o j√° est√° agendada, cobran√ßa ser√° estornada ap√≥s executar a liquida√ß√£o).
PAYMENT_RECEIVED_IN_CASH_UNDONE - Recebimento em dinheiro desfeito.
PAYMENT_CHARGEBACK_REQUESTED - Recebido chargeback.
PAYMENT_CHARGEBACK_DISPUTE - Em disputa de chargeback (caso sejam apresentados documentos para contesta√ß√£o).
PAYMENT_AWAITING_CHARGEBACK_REVERSAL - Disputa vencida, aguardando repasse da adquirente.
PAYMENT_DUNNING_RECEIVED - Recebimento de negativa√ß√£o.
PAYMENT_DUNNING_REQUESTED - Requisi√ß√£o de negativa√ß√£o.
PAYMENT_BANK_SLIP_VIEWED - Boleto da cobran√ßa visualizado pelo cliente.
PAYMENT_CHECKOUT_VIEWED - Fatura da cobran√ßa visualizada pelo cliente.
PAYMENT_SPLIT_CANCELLED - Cobran√ßa teve um split cancelado.
PAYMENT_SPLIT_DIVERGENCE_BLOCK - Valor da cobran√ßa bloqueado por diverg√™ncia de split.
PAYMENT_SPLIT_DIVERGENCE_BLOCK_FINISHED - Bloqueio do valor da cobran√ßa por diverg√™ncia de split foi finalizado.
Cada vez que um Webhook de cobran√ßa √© enviado, junto dele √© enviado um objeto em JSON via POST com os dados completos da cobran√ßa. Conforme este exemplo:

JSON

{
   "id": "evt_05b708f961d739ea7eba7e4db318f621&368604920",
   "event":"PAYMENT_RECEIVED",
   "dateCreated": "2024-06-12 16:45:03",
   "payment":{
      "object":"payment",
      "id":"pay_080225913252",
      "dateCreated":"2021-01-01",
      "customer":"cus_G7Dvo4iphUNk",
      "subscription":"sub_VXJBYgP2u0eO",  
         // somente quando pertencer a uma assinatura
      "installment":"2765d086-c7c5-5cca-898a-4262d212587c",
         // somente quando pertencer a um parcelamento
      "paymentLink":"123517639363",
         // identificador do link de pagamento
      "dueDate":"2021-01-01",
      "originalDueDate":"2021-01-01",
      "value":100,
      "netValue":94.51,
      "originalValue":null,
         // para quando o valor pago √© diferente do valor da cobran√ßa
      "interestValue":null,
      "nossoNumero": null,
      "description":"Pedido 056984",
      "externalReference":"056984",
      "billingType":"CREDIT_CARD",
      "status":"RECEIVED",
      "pixTransaction":null,
      "confirmedDate":"2021-01-01",
      "paymentDate":"2021-01-01",
      "clientPaymentDate":"2021-01-01",
      "installmentNumber": null,
      "creditDate":"2021-02-01",
      "custody": null,
      "estimatedCreditDate":"2021-02-01",
      "invoiceUrl":"https://www.asaas.com/i/080225913252",
      "bankSlipUrl":null,
      "transactionReceiptUrl":"https://www.asaas.com/comprovantes/4937311816045162",
      "invoiceNumber":"00005101",
      "deleted":false,
      "anticipated":false,
      "anticipable":false,
      "lastInvoiceViewedDate":"2021-01-01 12:54:56",
      "lastBankSlipViewedDate":null,
      "postalService":false,
      "creditCard":{
         "creditCardNumber":"8829",
         "creditCardBrand":"MASTERCARD",
         "creditCardToken":"a75a1d98-c52d-4a6b-a413-71e00b193c99"
      },
      "discount":{
         "value":0.00,
         "dueDateLimitDays":0,
         "limitedDate": null,
         "type":"FIXED"
      },
      "fine":{
         "value":0.00,
         "type":"FIXED"
      },
      "interest":{
         "value":0.00,
         "type":"PERCENTAGE"
      },
      "split":[
         {
            "id": "c788f2e1-0a5b-41b9-b0be-ff3641fb0cbe",
            "walletId":"48548710-9baa-4ec1-a11f-9010193527c6",
            "fixedValue":20,
            "status":"PENDING",
            "refusalReason": null,
            "externalReference": null,
            "description": null
         },
         {
            "id": "e754f2e1-09mn-88pj-l552-df38j1fbll1c",
            "walletId":"0b763922-aa88-4cbe-a567-e3fe8511fa06",
            "percentualValue":10,
            "status":"PENDING",
            "refusalReason": null,
            "externalReference": null,
            "description": null
         }
      ],
      "chargeback": {
          "status": "REQUESTED",
          "reason": "PROCESS_ERROR"
      },
      "refunds": null
   }
}
üëç
Retorno do Webhook com tipagem e ENUMs

Caso voc√™ queira saber qual o tipo de cada campo e os retornos de ENUMs dispon√≠veis, confira a resposta 200 no endpoint "Recuperar uma √∫nica cobran√ßa" na documenta√ß√£o.
Tudo no Asaas √© considerado uma cobran√ßa, inclusive transfer√™ncias diretas para a conta banc√°ria, dep√≥sitos ou recebimentos via Pix. Portanto voc√™ recebe Webhooks de Cobran√ßas para qualquer dinheiro que entrar na sua conta.

üöß
Com a entrada de novos produtos e fun√ß√µes dentro do Asaas, √© poss√≠vel que novos atributos sejam inclu√≠dos no Webhook. √â muito importante que seu c√≥digo esteja preparado para n√£o gerar exce√ß√µes caso o Asaas devolva novos atributos n√£o tratados pela sua aplica√ß√£o, pois isso poder√° causar interrup√ß√£o na fila de sincroniza√ß√£o.
Enviaremos um e-mail e avisaremos em nosso Discord quando novos campos forem inclu√≠dos no Webhook. O disparo ser√° feito para o e-mail de notifica√ß√£o definido nas configura√ß√µes do webhook.
O array de split ser√° devolvido apenas quando a cobran√ßa possuir configura√ß√µes de Split de Pagamento.
Como funciona o fluxo do Webhook de cobran√ßas?

Veja mais detalhes sobre o fluxo de webhooks em recebimentos de cobran√ßas no Asaas:

Cobran√ßa recebida em Boleto, sem atraso:
PAYMENT_CREATED > PAYMENT_CONFIRMED > PAYMENT_RECEIVED

Cobran√ßa recebida em Boleto, com atraso:
PAYMENT_CREATED > PAYMENT_OVERDUE > PAYMENT_CONFIRMED > PAYMENT_RECEIVED

Cobran√ßa recebida em Pix, sem atraso:
PAYMENT_CREATED -> PAYMENT_RECEIVED

Cobran√ßa recebida em Pix, com atraso:
PAYMENT_CREATED -> PAYMENT_OVERDUE -> PAYMENT_RECEIVED

Cobran√ßa recebida em Cart√£o de Cr√©dito, sem atraso:
PAYMENT_CREATED -> PAYMENT_CONFIRMED -> PAYMENT_RECEIVED (32 dias ap√≥s PAYMENT_CONFIRMED)

Cobran√ßa recebida em Cart√£o de D√©bito, sem atraso:
PAYMENT_CREATED -> PAYMENT_CONFIRMED -> PAYMENT_RECEIVED (3 dias ap√≥s PAYMENT_CONFIRMED)

Cobran√ßa recebida em Cart√£o de Cr√©dito, com atraso:
PAYMENT_CREATED -> PAYMENT_OVERDUE -> PAYMENT_CONFIRMED -> PAYMENT_RECEIVED (32 dias ap√≥s PAYMENT_CONFIRMED)

Cobran√ßa recebida em Cart√£o de D√©bito, com atraso:
PAYMENT_CREATED -> PAYMENT_OVERDUE -> PAYMENT_CONFIRMED -> PAYMENT_RECEIVED (3 dias ap√≥s PAYMENT_CONFIRMED)

Cobran√ßa estornada durante fase de confirma√ß√£o (Cart√£o de Cr√©dito/D√©bito):
PAYMENT_CREATED -> PAYMENT_CONFIRMED -> PAYMENT_REFUNDED

Cobran√ßa estornada ap√≥s recebimento (Cart√£o de Cr√©dito/D√©bito):
PAYMENT_CREATED -> PAYMENT_CONFIRMED -> PAYMENT_RECEIVED -> PAYMENT_REFUNDED

Cobran√ßa estornada ap√≥s recebimento (Boleto/Pix):
PAYMENT_CREATED -> PAYMENT_RECEIVED -> PAYMENT_REFUNDED

Chargeback solicitado, disputa aberta e ganha pelo cliente Asaas:
PAYMENT_CREATED -> PAYMENT_CONFIRMED ou PAYMENT_RECEIVED -> CHARGEBACK_REQUESTED -> CHARGEBACK_DISPUTE -> AWAITING_CHARGEBACK_REVERSAL -> PAYMENT_CONFIRMED ou PAYMENT_RECEIVED (depende se a cobran√ßa j√° atingiu a data de cr√©dito).

Chargeback solicitado, disputa aberta e ganha pelo cliente:
PAYMENT_CREATED -> PAYMENT_CONFIRMED ou PAYMENT_RECEIVED -> CHARGEBACK_REQUESTED -> CHARGEBACK_DISPUTE -> PAYMENT_REFUNDED

Chargeback solicitado e disputa n√£o aberta:
PAYMENT_CREATED -> PAYMENT_CONFIRMED ou PAYMENT_RECEIVED -> CHARGEBACK_REQUESTED -> PAYMENT_REFUNDED

Cobran√ßa confirmada em dinheiro:
PAYMENT_CREATED -> PAYMENT_RECEIVED (o billingType ser√° "RECEIVED_IN_CASH").

Cobran√ßa em processo de negativa√ß√£o Serasa:
PAYMENT_CREATED -> PAYMENT_OVERDUE -> PAYMENT_DUNNING_REQUESTED

Cobran√ßa em processo de negativa√ß√£o Serasa recebida:
PAYMENT_CREATED -> PAYMENT_OVERDUE -> PAYMENT_DUNNING_REQUESTED -> PAYMENT_DUNNING_RECEIVED

√â importante frisar que sempre que a cobran√ßa sofrer atraso de vencimento, ela passar√° pelo status PAYMENT_OVERDUE.

Ocasionalmente, outros eventos podem ser disparados, como PAYMENT_DELETED, PAYMENT_RESTORED, PAYMENT_BANK_SLIP_VIEWED e PAYMENT_CHECKOUT_VIEWED, por√©m s√£o eventos que n√£o est√£o ligados com processos de recebimento de valores.

Bloqueio do Firewall na CloudFlare
O CloudFlare √© uma das solu√ß√µes de Firewall mais utilizadas mundialmente para sites.
Suggest Edits
Se a sua solu√ß√£o de Firewall for CloudFlare e estiver enfrentando o erro HTTP 403 na sincroniza√ß√£o dos webhooks, voc√™ precisar√° criar algumas regras no seu Firewall para o correto funcionamento dos Webhooks Asaas com o seu sistema.


Primeiro, acesse as configura√ß√µes do dom√≠nio de seu sistema no CloudFlare. Ao expandir a Vis√£o Geral do dom√≠nio, v√° at√© o menu ‚ÄúSeguran√ßa > WAF‚Äù.

No lado direito, escolha a op√ß√£o ‚ÄúRegras de acesso de IP‚Äù e crie a regra de permitir todos os IPs oficiais do Asaas (clique no link para saber mais).


Obs.: em sandbox pode haver outros IPs, siga bloqueando, v√° em Seguran√ßa > Eventos e libere o IP bloqueado tamb√©m:


Ao acessar a p√°gina a lista de IPs bloqueados aparecer√£o na lista, basta copiar o IP e liber√°-los.

Finalizando a configura√ß√£o, basta acessar o menu de Configura√ß√µes do Webhook em sua conta Asaas, e reativar a fila de sincroniza√ß√£o para conferir se a situa√ß√£o est√° resolvida.

IPs oficiais do Asaas
Suggest Edits
O Asaas possui IPs oficiais pelos quais se comunica com sua aplica√ß√£o atrav√©s dos webhooks. Voc√™ pode utiliz√°-los para liberar acesso em sua aplica√ß√£o atrav√©s do firewall ou para bloquear outros IPs que n√£o sejam estes, por quest√£o de seguran√ßa.

52.67.12.206
18.230.8.159
54.94.136.112
54.94.183.101

Assinaturas
D√∫vidas frequentes sobre assinaturas na API do Asaas
Suggest Edits
Posso criar assinaturas com per√≠odo de gratuidade?

Se voc√™ trabalha com um per√≠odo de trial (7 dias gr√°tis, por exemplo), poder√° seguir da mesma forma e informar no campo nextDueDate a data da primeira cobran√ßa. Assim, se o cart√£o for validado na cria√ß√£o, ele j√° ser√° gravado para que o primeiro pagamento aconte√ßa no dia informado por voc√™.

Por√©m, se voc√™ criar a assinatura sem os dados do cart√£o e o pagador inserir depois os dados do cart√£o, o valor ser√° descontado no momento que ele inserir o cart√£o, independente do nextDueDate.

Como funcionam as notifica√ß√µes de assinaturas?

As notifica√ß√µes em cobran√ßas de assinaturas ser√£o enviadas conforme as configura√ß√µes de notifica√ß√£o definidas no cliente. Por√©m, existem algumas mudan√ßas de acordo com a forma de pagamento, veja abaixo:

Quando a forma de pagamento √© Cart√£o, mesmo que todas as notifica√ß√µes estejam habilitadas no cadastro do pagador, elas s√£o enviadas apenas quando h√° confirma√ß√£o de pagamento na primeira cobran√ßa (tanto para o cliente quanto para o pagador) e/ou quando h√° confirma√ß√£o de Pagamento em cobran√ßas futuras (apenas para o cliente).

Notifica√ß√£o de cobran√ßas antes do vencimento:
Essa notifica√ß√£o ser√° enviada apenas se o cliente clicar manualmente no bot√£o Reenviar E-mail/SMS/WhatsApp de notifica√ß√£o e a cobran√ßa precisa estar com o status aguardando pagamento.
Notifica√ß√£o para cobran√ßas vencidas:
Se essa op√ß√£o estiver ativa, o sistema ir√° disparar uma notifica√ß√£o apenas se houver falha no pagamento.
Outras notifica√ß√µes, mesmo que habilitadas, n√£o s√£o disparadas.
Quando a forma de pagamento √© Boleto/Pix ou Pergunte ao Cliente os envios das notifica√ß√µes s√£o realizados conforme configurado, com exce√ß√£o das notifica√ß√µes de Aviso de Gera√ß√£o de Cobran√ßa, pois na assinatura as cobran√ßas s√£o geradas sempre com 40 dias de anteced√™ncia. Caso esteja habilitada, essa notifica√ß√£o ser√° enviada apenas na primeira cobran√ßa. Se a assinatura estiver definida como Pergunte ao Cliente e for paga com Cart√£o, as pr√≥ximas ser√£o definidas com a forma de pagamento Cart√£o, sendo assim, come√ßa a seguir as regras de notifica√ß√µes para assinatura em cart√£o.

Como acompanho os webhooks de cobran√ßas de assinaturas?

A assinatura √© apenas uma configura√ß√£o de como queremos que de fato a cobran√ßa seja criada. O Asaas n√£o possui webhooks pr√≥prios para as assinaturas, apenas das cobran√ßas. Ent√£o, o gerenciamento deve ser realizado atrav√©s dos webhooks de cobran√ßas. Sempre ao criar uma nova assinatura, a primeira cobran√ßa dela √© gerada automaticamente e enviamos um webhook de PAYMENT_CREATED, onde nele cont√©m o id do subscription. Toda cobran√ßa que fa√ßa parte dessa assinatura, conter√° o atributo subscription no JSON do webhook, por onde voc√™ poder√° vincular que tal cobran√ßa faz parte de determinada assinatura.

